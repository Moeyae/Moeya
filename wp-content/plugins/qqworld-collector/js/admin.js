if(typeof QQWorldCollector=='undefined')window.QQWorldCollector={};QQWorldCollector.noty_theme=QC.noty_theme;QQWorldCollector.animation=QC.noty_animation;QQWorldCollector.loading_animation='<div class="loading pacman"></div>';QQWorldCollector.bulk_action={};QQWorldCollector.add_symbols=function(){var $=jQuery;var add_symbol=function(){var object=$(this).parent().prev();if(object.is('p'))object=object.prev();var text=$(this).text();if(document.selection){var pos=object.selection.createRange();pos.text=text}else{var obj=object.get(0);if(obj.selectionStart||obj.selectionStart=='0'){var startPos=obj.selectionStart;var endPos=obj.selectionEnd;obj.value=obj.value.substring(0,startPos)+text+obj.value.substring(endPos,obj.value.length)}else{obj.value+=text}}object.focus();return false};$(document).on('click','.symbol-block .symbol',add_symbol)};QQWorldCollector.field={switcher:function(args){var on=args.value==1?' checked':'';return'<div class="qqworld-collector onoffswitch">	<input type="text" name="'+args.name+'" class="onoffswitch-input" value="'+args.value+'">	<input type="checkbox" class="qc-onoffswitch-checkbox" id="'+args.id+'"'+on+'><label class="onoffswitch-label" for="'+args.id+'"></label></div>'}};QQWorldCollector.cookies={Get:function(sName){var aCookie=document.cookie.split("; ");for(var i=0;i<aCookie.length;i++){var aCrumb=aCookie[i].split("=");if(sName==aCrumb[0])return unescape(aCrumb[1])}return null},Set:function(sName,sValue,time){var date=new Date();var timeZoneOffset=date.getTimezoneOffset();date.setTime(date.getTime()-timeZoneOffset*60*1000+time);document.cookie=sName+"="+escape(sValue)+"; path=/; expires="+date.toGMTString()}};QQWorldCollector.strlen=function(str,charset){var total=0;var charCode,i,len;charset=charset?charset.toLowerCase():'';if(charset==='utf-16'||charset==='utf16'){for(i=0,len=str.length;i<len;i++){charCode=str.charCodeAt(i);if(charCode<=0xffff){total+=2}else{total+=4}}}else{for(i=0,len=str.length;i<len;i++){charCode=str.charCodeAt(i);if(charCode<=0x007f){total+=1}else if(charCode<=0x07ff){total+=2}else if(charCode<=0xffff){total+=3}else{total+=4}}}return total};QQWorldCollector.AjaxJsonDataFilter=function(data,type){var count=0;var temp=data;var parse=function(data){data=data.replace(/^[^\{]*\{/i,'{');try{var json=JSON.parse(data)}catch(e){count++;if(count>10){return temp}else{data=data.replace(/^\{/i,'');data=parse(data)}}return data};data=parse(data);return data};QQWorldCollector.padding=function(num,length){for(var len=(num+"").length;len<length;len=num.length){num="0"+num}return num};QQWorldCollector.isGutenbergActive=function(){var $=jQuery;return typeof wp!=='undefined'&&typeof wp.blocks!=='undefined'&&$('body').hasClass('block-editor-page')};QQWorldCollector.scrollTo={offset:function(){var $=jQuery;return{top:-$('#wpadminbar').height()-10,left:0}}};QQWorldCollector.randomNum=function(min,max){switch(arguments.length){case 1:return parseInt(Math.random()*min+1,10);break;case 2:return parseInt(Math.random()*(max-min+1)+min,10);break;default:return 0;break}};QQWorldCollector.randomWord=function(randomFlag,min,max){var str="",range=min,arr=['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];if(randomFlag){range=Math.round(Math.random()*(max-min))+min}for(var i=0;i<range;i++){pos=Math.round(Math.random()*(arr.length-1));str+=arr[pos]}return str};QQWorldCollector.in_array=function(obj,arr){for(var a in arr){if(obj==arr[a])return true}return false};QQWorldCollector.unique=function(){return Math.floor(Date.now())+QQWorldCollector.randomNum(0,9999999999)};QQWorldCollector.navTabWrapper=function(){var $=jQuery,that=this;this.action={};this.action.get_current_tab=function(){var link=window.location.href;var parser=document.createElement('a');parser.href=link;var hash=parser.hash;if(hash){tab=hash.replace('#','')}else tab=$('#qqworld-collector-nav-tab-wrapper .nav-tab:first').attr('href').replace('#','');return tab};this.action.set_current_tab=function(){var tab=that.action.get_current_tab();$('#'+tab+'-nav').click()};this.action.switch_tab=function(e){var that=this;if($(this).hasClass('nav-tab-active'))return;$('#qqworld-collector-nav-tab-wrapper .nav-tab').removeClass('nav-tab-active');$(this).addClass('nav-tab-active');var index=$('#qqworld-collector-nav-tab-wrapper .nav-tab').index(this);$('#qqworld-collector-nav-tab-wrapper').closest('.wrap').find('.nav-section').slideUp('normal').eq(index).slideDown('normal');setTimeout(function(){$(that).closest('form').find('[name="_wp_http_referer"]').val(window.location.href)},100);$(this).blur()};this.create={};this.create.navIds=function(){$('#qqworld-collector-nav-tab-wrapper .nav-tab').each(function(){var id=$(this).attr('href').replace('#','')+'-nav';$(this).attr('id',id)})};this.create.events=function(){$(document).on('click','#qqworld-collector-nav-tab-wrapper .nav-tab',that.action.switch_tab)};this.create.init=function(){if(!$('#qqworld-collector-nav-tab-wrapper').length)return false;that.create.navIds();that.create.events();that.action.set_current_tab()};this.create.init()};QQWorldCollector.navTab_environment=function(){var $=jQuery;if($('body').hasClass('toplevel_page_qqworld-collector')&&!$('body').hasClass('qqworld-collector-activated')){$('#environment-nav').append('<span>'+QC.text.check_this+'</span>')}};QQWorldCollector.quick_symbol=function(){var $=jQuery,that=this;this.action={};this.action.add_symbol=function(){var object=$(this).parent().prev().children().eq(0);var text=$(this).text();if(document.selection){var pos=object.selection.createRange();pos.text=text}else{var obj=object.get(0);if(obj.selectionStart||obj.selectionStart=='0'){var startPos=obj.selectionStart;var endPos=obj.selectionEnd;obj.value=obj.value.substring(0,startPos)+text+obj.value.substring(endPos,obj.value.length)}else{obj.value+=text}}object.focus();return false};this.create={};this.create.events=function(){};this.create.init=function(){$(document).on('click','.quick-symbol-block .symbol',that.action.add_symbol)};this.create.init()};QQWorldCollector.switch_button_action=function(){var $=jQuery;$(document).on('change','.qqworld-collector .qc-onoffswitch-checkbox',function(){if($(this).is(':checked'))$(this).prev('.onoffswitch-input').val(1).change();else $(this).prev('.onoffswitch-input').val(0).change()})};QQWorldCollector.editor={mode:function(){var $=jQuery;if(QQWorldCollector.isGutenbergActive()){var mode='gutenberg'}else{var mode='text';if(typeof tinyMCE!='undefined'&&tinyMCE.activeEditor){var id=tinyMCE.activeEditor.id;mode=$('#'+id).is(':visible')?'text':'virtual'}}return mode},title:{get:function(){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':var title=wp.data.select("core/editor").getEditedPostAttribute('title');break;case'text':case'virtual':var title=$('#title').val();break}return title},set:function(title){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':wp.data.dispatch('core/editor').editPost({title:title});break;case'text':case'virtual':$('#title').val(title);break}}},excerpt:{get:function(){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':var excerpt=wp.data.select("core/editor").getEditedPostAttribute('excerpt');break;case'text':case'virtual':var excerpt=$('textarea[name="excerpt"]').val();break}return excerpt},set:function(excerpt){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':wp.data.dispatch('core/editor').editPost({excerpt:excerpt});break;case'text':case'virtual':$('textarea[name="excerpt"]').val(excerpt);break}}},content:{editor_id:null,get:function(id){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':var content=wp.data.select("core/editor").getEditedPostContent();break;case'text':if(typeof id=='undefined'){id=this.editor_id?this.editor_id:'#content'}var content=$(id).val();break;case'virtual':var content=tinyMCE.activeEditor.getContent();break}return content},set:function(content,id){var $=jQuery;var mode=QQWorldCollector.editor.mode();switch(mode){case'gutenberg':wp.data.dispatch('core/editor').editPost({content:content});var block=wp.blocks.createBlock('core/freeform',{content:content});wp.data.dispatch('core/editor').resetBlocks([block]);break;case'text':if(typeof id=='undefined'){id=this.editor_id?this.editor_id:'#content'}$(id).val(content);break;case'virtual':tinyMCE.activeEditor.setContent(content);break}}}};QQWorldCollector.boxRatio=function(){var $=jQuery,that=this;this.action={};this.action.resize=function(){if(!$('.QWBoxStyle').length)return false;$('.QWBoxStyle').each(function(){var ratio=$(this).data('ratio').split(':');var w=parseInt(ratio[0]);var h=parseInt(ratio[1]);$(this).css('width','100%');var width=$(this).width();$(this).css('height',width*h/w+'px')})};this.create={};this.create.events=function(){$(window).on('resize',that.action.resize)};this.create.init=function(){setInterval(that.action.resize,1000);that.create.events()};this.create.init()};QQWorldCollector.extend=function(def,obj){if(!obj){return def}else if(!def){return obj}for(var i in obj){if(obj[i]!=null&&obj[i].constructor==Object){def[i]=QQWorldCollector.extend(def[i],obj[i])}else if(obj[i]!=null&&(obj[i]instanceof Array)&&obj[i].length>0){if(obj[i][0].constructor==Object){var newobjs=[];var objids={};for(var x=0,l=def[i].length;x<l;x++){objids[def[i][x].id]=x}for(var x=0,l=obj[i].length;x<l;x++){var newobj=obj[i][x];if(objids[newobj.id]!==undefined){def[i][x]=QQWorldCollector.extend(def[i][x],newobj)}else{newobjs.push(newobj)}}for(var x=0,l=newobjs.length;x<l;x++){def[i].push(newobjs[x])}}else{for(var x=0;x<obj[i].length;x++){var idxObj=obj[i][x];if(typeof def[i]!='undefined'&&def[i].indexOf(idxObj)===-1){def[i].push(idxObj)}}}}else{if(isNaN(obj[i])||i.indexOf('_key')>-1){def[i]=obj[i]}else{def[i]+=obj[i]}}}return def};QQWorldCollector.hook=function(){var that=this;this.filters=new Array();this.actions=new Array();this.add_action=function(){var name=arguments[0];var func=arguments[1];var priority=typeof arguments[2]!='undefined'?arguments[2]:10;if(arguments.length>2){var args=new Array();for(var a in arguments){if(a>1)args.push(arguments[a])}}if(typeof that.actions[name]=="undefined"||!that.actions[name].length)that.actions[name]=new Array();that.actions[name].push({priority:priority,fn:func})};this.do_action=function(){var name=arguments[0];var args=new Array();for(var a in arguments){if(a!=0)args.push(arguments[a])}var value=typeof arguments[1]!="undefined"?arguments[1]:"";if(typeof that.actions[name]!="undefined"&&that.actions[name].length){that.actions[name].sort(function(x,y){return x.priority-y.priority});for(var f in that.actions[name]){args[0]=value;try{var fn=eval(that.actions[name][f].fn);fn.apply(this,args)}catch(e){console.log(e)}}}};this.remove_action=function(tag,function_to_remove,priority){if(typeof that.actions[tag]!='undefined'){if(typeof function_to_remove!='undefined'){priority=priority?priority:10;for(var i in that.actions[tag]){if(that.actions[tag][i].fn.toString()===function_to_remove.toString()&&that.actions[tag][i].priority===priority){delete that.actions[tag][i]}}}else{delete that.actions[tag]}}};this.add_filter=function(){var name=arguments[0];var func=arguments[1];var priority=typeof arguments[2]!='undefined'?arguments[2]:10;if(arguments.length>2){var args=new Array();for(var a in arguments){if(a>1)args.push(arguments[a])}}if(typeof that.filters[name]=="undefined"||!that.filters[name].length)that.filters[name]=new Array();that.filters[name].push({priority:priority,fn:func})};this.apply_filters=function(){var name=arguments[0];var args=new Array();for(var a in arguments){if(a!=0)args.push(arguments[a])}var value=typeof arguments[1]!="undefined"?arguments[1]:"";if(typeof that.filters[name]!="undefined"&&that.filters[name].length){that.filters[name].sort(function(x,y){return x.priority-y.priority});for(var f in that.filters[name]){args[0]=value;try{var fn=eval(that.filters[name][f].fn);value=fn.apply(this,args)}catch(e){console.log(e)}}}return value};this.remove_filter=function(tag,function_to_remove,priority){if(typeof that.filters[tag]!='undefined'){if(typeof function_to_remove!='undefined'){priority=priority?priority:10;for(var i in that.filters[tag]){if(that.filters[tag][i].fn.toString()===function_to_remove.toString()&&that.filters[tag][i].priority===priority){delete that.filters[tag][i]}}}else{delete that.filters[tag]}}}};window.qHook=new QQWorldCollector.hook();QQWorldCollector.check_duplicated_title=function(){var $=jQuery,that=this;this.action={};this.action.check=function(){if(!QC.check_duplicated_title)return false;$.ajax({url:ajaxurl,data:{action:'qqworld-collector-check-duplicated-title',title:$(this).val(),ID:$('#post_ID').val()},type:'POST',dataType:'json',success:function(respond){if(respond.duplicated_titles){new Noty({text:respond.msg,animation:QQWorldCollector.animation,type:'error',layout:'topCenter',theme:QQWorldCollector.noty_theme,modal:true,closeWith:['button'],}).show()}},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(XMLHttpRequest);new Noty({text:XMLHttpRequest.statusText+': '+XMLHttpRequest.responseText,animation:QQWorldCollector.animation,type:'error',layout:'center',theme:QQWorldCollector.noty_theme,modal:true,dismissQueue:true,closeWith:['button'],}).show()}})};this.create={};this.create.events=function(){$(document).on('change','#titlewrap > #title',that.action.check)};this.create.init=function(){that.create.events()};this.create.init()};QQWorldCollector.plugin=function(){var $=jQuery;var url=ajaxurl.replace('wp-admin/admin-ajax.php','');var html='<p id="qqworld-collector-settings"><img src="'+url+'wp-content/plugins/qqworld-collector/images/banner-772x250.jpg" width="772" height="250" id="banner" /></p>';$('tr[data-plugin="qqworld-collector/qqworld-collector.php"] .plugin-description').after(html)};QQWorldCollector.upgrade=function(){var $=jQuery,that=this,oNoty;this.action={};this.action.check_upgrade=function(){var button=$(this);button.attr('disabled','disabled');oNoty=new Noty({text:button.data('action'),animation:QQWorldCollector.animation,type:'warning',layout:'center',theme:QQWorldCollector.noty_theme,modal:true}).show();$.ajax({url:ajaxurl,data:{action:'qqworld-collector-check-upgrade',version:button.data('version')},type:'POST',dataType:'json',success:function(respond){oNoty.close();if(respond.success){var n=new Noty({text:respond.msg,animation:QQWorldCollector.animation,type:'warning',layout:'center',theme:QQWorldCollector.noty_theme,dismissQueue:true,modal:true,closeWith:['button'],buttons:[Noty.button(QC.text.yes,'button button-primary',function(){n.close();oNoty=new Noty({text:QQWorldCollector.loading_animation,animation:QQWorldCollector.animation,type:'info',layout:'center',theme:QQWorldCollector.noty_theme}).show();$.ajax({type:'POST',url:ajaxurl,data:{action:'qqworld-collector-do-upgrade',fileUrl:respond.fileUrl},dataType:'json',success:function(respond){oNoty.close();var options={layout:'center',theme:QQWorldCollector.noty_theme,text:respond.msg};if(respond.success){options.type='success';options.timeout=3000}else{options.type='error';options.timeout=5000}var n=new Noty(options).show();setTimeout(function(){$('#update-form-qqworld-collector').submit()},2000)},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(XMLHttpRequest);new Noty({text:QC.text.error+'<br />'+XMLHttpRequest.statusText+': '+XMLHttpRequest.responseText,animation:QQWorldCollector.animation,type:'error',layout:'center',theme:QQWorldCollector.noty_theme,modal:true}).show();oNoty.close();button.removeAttr('disabled')}})},{id:'button-yes','data-status':'ok'}),Noty.button(QC.text.no,'button',function(){n.close();button.removeAttr('disabled')})]}).show()}else{new Noty({text:respond.msg,animation:QQWorldCollector.animation,type:'error',layout:'center',theme:QQWorldCollector.noty_theme,modal:true}).show();button.removeAttr('disabled')}},error:function(XMLHttpRequest,textStatus,errorThrown){button.removeAttr('disabled');console.log(XMLHttpRequest);new Noty({text:XMLHttpRequest.statusText+': '+XMLHttpRequest.responseText,animation:QQWorldCollector.animation,type:'error',layout:'center',theme:QQWorldCollector.noty_theme,modal:true,dismissQueue:true,closeWith:['button'],}).show()}})};this.create={};this.create.events=function(){$(document).on('click','#check-upgrade',that.action.check_upgrade)};this.create.init=function(){that.create.events()};this.create.init()};jQuery(function($){QQWorldCollector.add_symbols();QQWorldCollector.navTabWrapper();QQWorldCollector.navTab_environment();QQWorldCollector.switch_button_action();QQWorldCollector.boxRatio();QQWorldCollector.quick_symbol();QQWorldCollector.check_duplicated_title();QQWorldCollector.plugin();QQWorldCollector.upgrade()});